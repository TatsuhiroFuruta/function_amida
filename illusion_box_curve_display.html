<canvas id="canvas" width="500" height="300" style="border:1px solid #ccc;"></canvas>
<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const width = canvas.width;
const height = canvas.height;

// 正方形のサイズ
const squareSize = 40;

// 正方形リスト
let squares = [];

// ---- 曲線を描く関数 ----
function drawCurve() {
  ctx.beginPath();
  ctx.moveTo(0, height / 2);
  for (let x = 0; x <= width; x += 1) {
    const y = height / 2 - 50 * Math.sin(x * 0.02);
    ctx.lineTo(x, y);
  }
  ctx.strokeStyle = "blue";
  ctx.lineWidth = 2;
  ctx.stroke();
}

// ---- 初期化：正方形を配置 ----
function initSquares() {
  for (let x = 0; x < width; x += squareSize) {
    for (let y = 0; y < height; y += squareSize) {
      squares.push({ x, y, visible: true });
    }
  }
}

// ---- 描画全体 ----
function drawAll() {
  ctx.clearRect(0, 0, width, height);
  drawCurve();
  // 正方形を上に描く
  for (const sq of squares) {
    if (sq.visible) {
      ctx.fillStyle = "lightgray";
      ctx.fillRect(sq.x, sq.y, squareSize, squareSize);
      ctx.strokeRect(sq.x, sq.y, squareSize, squareSize);
    }
  }
}

// ---- クリックで正方形を消す ----
canvas.addEventListener("click", (e) => {
  const x = e.offsetX;
  const y = e.offsetY;
  for (const sq of squares) {
    if (
      x >= sq.x &&
      x <= sq.x + squareSize &&
      y >= sq.y &&
      y <= sq.y + squareSize
    ) {
      sq.visible = false; // 削除（= はがす）
    }
  }
  drawAll();
});

// ---- 初期化と描画 ----
initSquares();
drawAll();
</script>
